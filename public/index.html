<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LEEHWA VW TM System</title>
  <script src="https://cdn.tailwindcss.com/3.4.0"></script>
  <script>
    // Suppress Tailwind CSS production warning
    tailwind.config = {
      theme: {
        extend: {}
      }
    }
  </script>
  
  <!-- Core Libraries -->
  <!-- ExcelJS for Truck Management -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.4.0/exceljs.min.js"></script>
  <!-- XLSX.js for FIFO Upload -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/handsontable@13.0.0/dist/handsontable.full.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable@13.0.0/dist/handsontable.full.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.6/dist/umd/supabase.min.js"></script>
  
  <!-- Core Scripts -->
  <script type="application/javascript" src="/js/core/utils.js"></script>
  <script type="application/javascript" src="/js/supabase-config.js"></script>
  <script type="application/javascript" src="/js/navigation.js"></script>
  
  <!-- Global Function Definitions -->
  <script>
    // Ensure global functions are always available
    window.globalFunctions = {
      // Placeholder functions that will be replaced when pages load
      openExcelModal: function() {
        console.log('‚ö†Ô∏è Global openExcelModal placeholder called - page not fully loaded yet');
        alert('Please wait for the page to fully load, then try again.');
      },
      closeExcelModal: function() {
        console.log('‚ö†Ô∏è Global closeExcelModal placeholder called - page not fully loaded yet');
      },
      // Add placeholder for filterByDate to prevent errors
      filterByDate: function() {
        console.log('‚ö†Ô∏è Global filterByDate placeholder called - page not fully loaded yet');
      }
    };
    
    // Make functions globally accessible
    window.openExcelModal = window.globalFunctions.openExcelModal;
    window.closeExcelModal = window.globalFunctions.closeExcelModal;
    window.filterByDate = window.globalFunctions.filterByDate;
    
    console.log('üåê Global functions initialized in index.html');
  </script>
  
  <!-- Inline CSS - All necessary styles included -->
  <style>
    /* Critical CSS for basic functionality */
    .truck-management-page {
      font-family: 'Arial', sans-serif;
      background: #f8f9fa;
      margin: 0;
      padding: 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 30px;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .header h1 {
      color: #2c3e50;
      margin: 0;
      font-size: 2.5rem;
    }
    
    .header p {
      color: #7f8c8d;
      margin: 10px 0 0 0;
      font-size: 1.1rem;
    }
    
    .main-section {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    
    .section-title {
      color: #2c3e50;
      margin: 0 0 20px 0;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
      font-size: 1.8rem;
    }
    
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      text-decoration: none;
      display: inline-block;
    }
    
    .btn-primary {
      background: #3498db;
      color: white;
    }
    
    .btn-primary:hover {
      background: #2980b9;
      transform: translateY(-2px);
    }
    
    .btn-success {
      background: #27ae60;
      color: white;
    }
    
    .btn-success:hover {
      background: #229954;
      transform: translateY(-2px);
    }
    
    .btn-warning {
      background: #f39c12;
      color: white;
    }
    
    .btn-warning:hover {
      background: #e67e22;
      transform: translateY(-2px);
    }
    
    .btn-secondary {
      background: #6c757d;
      color: white;
    }
    
    .btn-secondary:hover {
      background: #5a6268;
      transform: translateY(-2px);
    }
    
    .current-trucks {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .current-trucks h3 {
      color: #2c3e50;
      margin: 0 0 20px 0;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
    }
    
    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }
    
    .modal-content {
      background-color: white;
      margin: 2% auto;
      padding: 20px;
      border: none;
      width: 90%;
      max-width: 1200px;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #3498db;
    }
    
    .modal-header h2 {
      color: #2c3e50;
      margin: 0;
      font-size: 2rem;
    }
    
    .close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
    
    .close:hover {
      color: black;
    }
    
    .date-selection {
      margin-bottom: 20px;
      text-align: center;
    }
    
    .date-selection label {
      font-weight: bold;
      margin-right: 15px;
      font-size: 1.1rem;
      color: #2c3e50;
    }
    
    .date-selection input[type="date"] {
      padding: 10px 15px;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 1rem;
      margin-right: 15px;
    }
    
    .date-selection button {
      padding: 10px 20px;
      background: #6c757d;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
    }
    
    .table-container {
      margin-bottom: 20px;
    }
    
    .table-header {
      background: #34495e;
      color: white;
      padding: 15px;
      text-align: center;
      border-radius: 8px 8px 0 0;
    }
    
    .table-header h3 {
      margin: 0;
      font-size: 1.3rem;
    }
    
    .handsontable-container {
      border: 2px solid #34495e;
      border-radius: 0 0 8px 8px;
      overflow: hidden;
    }
    
    .modal-actions {
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    
    .hidden {
      display: none;
    }
    
    /* Truck Status Page Styles */
    .truck-status-page {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      margin: 0;
      padding: 20px;
      color: white;
      min-height: 100vh;
    }
    
    .truck-status-page .header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .truck-status-page .header h1 {
      font-size: 6rem;
      margin: 0;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.6);
      font-weight: 900;
    }
    
    .truck-status-page .header p {
      font-size: 3rem;
      margin: 15px 0;
      opacity: 0.95;
      font-weight: 600;
    }
    
    .truck-status-page .date-selector {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .truck-status-page .date-selector input {
      font-size: 2.5rem;
      padding: 20px 35px;
      border: 3px solid #3498db;
      border-radius: 15px;
      background: rgba(255,255,255,0.95);
      color: #2c3e50;
      font-weight: bold;
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
      transition: all 0.3s ease;
    }
    
    .truck-status-page .status-table {
      background: rgba(255,255,255,0.95);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      margin-bottom: 30px;
    }
    
    .truck-status-page .table-header {
      background: linear-gradient(135deg, #2c5aa0, #1e3c72);
      color: white;
      padding: 25px;
      text-align: center;
      border-bottom: 3px solid #34495e;
    }
    
    .truck-status-page .table-header h2 {
      margin: 0;
      font-size: 3.5rem;
      font-weight: 900;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }
    
    .truck-status-page table {
      width: 100%;
      border-collapse: collapse;
      font-size: 2.2rem;
    }
    
    .truck-status-page th {
      background: #2c3e50;
      color: white;
      padding: 25px 20px;
      text-align: left;
      font-weight: bold;
      font-size: 2rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .truck-status-page td {
      padding: 25px 20px;
      border-bottom: 2px solid #ecf0f1;
      color: #2c3e50;
      font-weight: 500;
    }
    
    .truck-status-page tr:hover {
      background: #f8f9fa;
    }
    
    .status-badge {
      padding: 15px 25px;
      border-radius: 25px;
      font-weight: bold;
      text-align: center;
      min-width: 160px;
      font-size: 1.6rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .status-departed {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      color: white;
      border: 2px solid #c0392b;
    }
    
    .status-arrived {
      background: linear-gradient(135deg, #27ae60, #229954);
      color: white;
      border: 2px solid #229954;
    }
    
    .status-scheduled {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
      border: 2px solid #2980b9;
    }
    
    .status-onsite {
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: white;
      border: 2px solid #e67e22;
    }
    
    .status-shipped {
      background: linear-gradient(135deg, #95a5a6, #7f8c8d);
      color: white;
      border: 2px solid #7f8c8d;
    }
    
    .row-shipped {
      background-color: #e8f5e8 !important;
      border-left: 5px solid #27ae60 !important;
    }
    
    .truck-status-page .no-data {
      text-align: center;
      padding: 60px;
      font-size: 2.5rem;
      color: #7f8c8d;
    }
    
    .truck-status-page .auto-refresh {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(52, 73, 94, 0.9));
      color: white;
      padding: 15px 20px;
      border-radius: 25px;
      font-size: 1.4rem;
      font-weight: bold;
      border: 2px solid #3498db;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
    }
    
    /* FIFO Upload Page Styles */
    .fifo-upload-page {
      font-family: 'Arial', sans-serif;
      background: #f8f9fa;
      margin: 0;
      padding: 20px;
    }
    
    .fifo-upload-page .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .fifo-upload-page .header {
      text-align: center;
      margin-bottom: 30px;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .fifo-upload-page .header h1 {
      color: #2c3e50;
      margin: 0;
      font-size: 2.5rem;
    }
    
    .fifo-upload-page .header p {
      color: #7f8c8d;
      margin: 10px 0 0 0;
      font-size: 1.1rem;
    }
    
    .fifo-upload-page .upload-area {
      background: white;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: center;
      border: 2px dashed #3498db;
      transition: all 0.3s ease;
    }
    
    .fifo-upload-page .upload-area:hover {
      border-color: #2980b9;
      background-color: #f8f9fa;
    }
    
    .fifo-upload-page .upload-area.drag-over {
      border-color: #27ae60;
      background-color: #e8f5e8;
    }
    
    .fifo-upload-page .upload-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      color: #3498db;
    }
    
    .fifo-upload-page .upload-text {
      font-size: 1.5rem;
      color: #2c3e50;
      margin-bottom: 10px;
    }
    
    .fifo-upload-page .upload-subtext {
      font-size: 1rem;
      color: #7f8c8d;
      margin-bottom: 30px;
    }
    
    .fifo-upload-page .file-input {
      display: none;
    }
    
    .fifo-upload-page .upload-btn {
      background: #3498db;
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .fifo-upload-page .upload-btn:hover {
      background: #2980b9;
      transform: translateY(-2px);
    }
    
    .fifo-upload-page .file-info {
      margin-top: 20px;
      padding: 15px;
      background: #e8f5e8;
      border-radius: 8px;
      border: 1px solid #27ae60;
    }
    
    .fifo-upload-page .file-name {
      font-weight: bold;
      color: #27ae60;
    }
    
    .fifo-upload-page .file-size {
      color: #7f8c8d;
      font-size: 0.9rem;
    }
    
    .fifo-upload-page .upload-progress {
      margin-top: 20px;
      background: #ecf0f1;
      border-radius: 8px;
      overflow: hidden;
    }
    
    .fifo-upload-page .progress-bar {
      height: 20px;
      background: #3498db;
      transition: width 0.3s ease;
    }
    
    .fifo-upload-page .progress-text {
      text-align: center;
      margin-top: 10px;
      font-weight: bold;
      color: #2c3e50;
    }
    
    .fifo-upload-page .status-message {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      font-weight: bold;
      text-align: center;
    }
    
    .fifo-upload-page .status-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .fifo-upload-page .status-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    /* Analysis Page Styles */
    .analysis-page {
      font-family: 'Arial', sans-serif;
      background: #f8f9fa;
      margin: 0;
      padding: 20px;
    }
    
    .analysis-page .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .analysis-page .header {
      text-align: center;
      margin-bottom: 30px;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .analysis-page .header h1 {
      color: #2c3e50;
      margin: 0;
      font-size: 2.5rem;
    }
    
    .analysis-page .header p {
      color: #7f8c8d;
      margin: 10px 0 0 0;
      font-size: 1.1rem;
    }
    
    .analysis-page .filter-section {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    
    .analysis-page .filter-title {
      color: #2c3e50;
      margin: 0 0 20px 0;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
      font-size: 1.8rem;
    }
    
    .analysis-page .filter-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .analysis-page .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .analysis-page .filter-group label {
      font-weight: bold;
      color: #2c3e50;
      font-size: 0.9rem;
    }
    
    .analysis-page .filter-group input,
    .analysis-page .filter-group select {
      padding: 10px;
      border: 2px solid #e9ecef;
      border-radius: 6px;
      font-size: 1rem;
    }
    
    .analysis-page .filter-group input:focus,
    .analysis-page .filter-group select:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    .analysis-page .filter-actions {
      display: flex;
      gap: 15px;
      justify-content: center;
    }
    
    .analysis-page .results-section {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .analysis-page .results-title {
      color: #2c3e50;
      margin: 0 0 20px 0;
      border-bottom: 2px solid #3498db;
      padding-bottom: 10px;
      font-size: 1.8rem;
    }
    
    .analysis-page .results-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    
    .analysis-page .results-table th {
      background: #2c3e50;
      color: white;
      padding: 15px 10px;
      text-align: left;
      font-weight: bold;
    }
    
    .analysis-page .results-table td {
      padding: 15px 10px;
      border-bottom: 1px solid #ecf0f1;
    }
    
    .analysis-page .results-table tr:hover {
      background: #f8f9fa;
    }
    
    .analysis-page .export-section {
      margin-top: 20px;
      text-align: center;
    }
    
    .analysis-page .export-btn {
      background: #27ae60;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .analysis-page .export-btn:hover {
      background: #229954;
      transform: translateY(-2px);
    }
    
    /* Fullscreen mode styles removed - STATUS page opens in new tab */
    
    /* Common Layout - All pages use full width */
    main {
      margin-left: 0 !important;
      width: calc(100vw - 16rem) !important; /* 16rem = 256px (w-64) */
      max-width: calc(100vw - 16rem) !important;
    }
    
    #mainContent {
      width: 100% !important;
      max-width: 100% !important;
    }
    
    /* Ensure all page containers use full width */
    .container, .truck-management-page .container, .fifo-upload-page .container, .analysis-page .container {
      max-width: none !important;
      width: 100% !important;
    }
    
    /* Make sure tables and content stretch to full width */
    .handsontable-container, .status-table, .results-table {
      width: 100% !important;
      max-width: 100% !important;
    }
    
    /* Ensure sidebar is always visible for non-status pages */
    .w-64 {
      display: block !important;
    }
    
    /* Ensure main content doesn't overlap sidebar */
    main {
      margin-left: 16rem !important; /* 256px - sidebar width */
      width: calc(100vw - 16rem) !important;
    }
    
    /* Force sidebar visibility for all non-status pages */
    #mainSidebar {
      display: block !important;
      width: 16rem !important;
      position: relative !important;
      z-index: 1000 !important;
    }
    
    /* Ensure main content area respects sidebar */
    #mainContentArea {
      margin-left: 16rem !important;
      width: calc(100vw - 16rem) !important;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="flex h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-lg border-r border-gray-200" id="mainSidebar">
      <div class="p-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
          <span class="text-3xl mr-2">üîÑ</span>
          LEEHWA VW TM System
        </h2>
        <nav>
          <ul class="space-y-2">
            <!-- FIFO Management Section -->
            <li class="pt-2">
              <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 px-4">
                FIFO Management
              </div>
              <ul class="space-y-1 ml-2">
                <li><button onclick="loadPage('pages/fifo/upload.html')" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors duration-200 flex items-center">
                  <span class="text-lg mr-3">üì§</span>
                  Excel Upload
                </button></li>
                <li><button onclick="loadPage('pages/analysis-new.html')" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors duration-200 flex items-center">
                  <span class="text-lg mr-3">üìä</span>
                  Shipping Plan Analysis
                </button></li>
                <li><button onclick="loadPage('pages/packaging-analysis-fixed.html')" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors duration-200 flex items-center">
                  <span class="text-lg mr-3">üì¶</span>
                  Packaging Analysis
                </button></li>
              </ul>
            </li>
            
            <!-- Truck Status Section -->
            <li class="pt-4">
              <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 px-4">
                Truck Status
              </div>
              <ul class="space-y-1 ml-2">
                                 <li><button onclick="openStatusInNewTab()" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors duration-200 flex items-center">
                   <span class="text-lg mr-3">üì∫</span>
                   Live Status Display
                 </button></li>
                <li><button onclick="forceLoadPage('pages/truck/management.html')" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-md transition-colors duration-200 flex items-center">
                  <span class="text-lg mr-3">üöõ</span>
                  Truck Management
                </button></li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
    </aside>
    
    <!-- Main Content -->
    <main class="flex-1 overflow-hidden" id="mainContentArea">
      <div class="h-full flex flex-col">
        <!-- Content Header -->
        <header class="bg-white border-b border-gray-200 px-6 py-4" id="contentHeader">
          <div class="flex items-center justify-between">
            <h1 class="text-2xl font-semibold text-gray-800" id="pageTitle">Welcome to TM System</h1>
            <div class="flex items-center space-x-4">
              <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                System Status
              </span>
            </div>
          </div>
        </header>
        
        <!-- Content Body -->
        <div class="flex-1 overflow-y-auto p-6" id="mainContent">
          <!-- Welcome Content -->
          <div class="welcome-content">
            <h2 class="text-4xl font-bold text-gray-800 mb-6 text-center">Welcome to TM System</h2>
            <p class="text-xl text-gray-600 text-center mb-12">Efficient FIFO Management and Truck Status Monitoring</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
              <!-- FIFO Management -->
              <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300">
                <div class="text-4xl mb-4">üì¶</div>
                <h3 class="text-xl font-semibold text-gray-800 mb-3">FIFO Management</h3>
                <p class="text-gray-600">Upload Excel files and analyze shipping plans efficiently.</p>
              </div>
              
              <!-- Truck Management -->
              <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300">
                <div class="text-4xl mb-4">üöõ</div>
                <h3 class="text-xl font-semibold text-gray-800 mb-3">Truck Management</h3>
                <p class="text-gray-600">Monitor real-time truck status and manage fleet operations.</p>
              </div>
              
              <!-- System Overview -->
              <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow duration-300">
                <div class="text-4xl mb-4">‚öôÔ∏è</div>
                <h3 class="text-xl font-semibold text-gray-800 mb-3">System Overview</h3>
                <p class="text-gray-600">Comprehensive dashboard for monitoring and controlling operations.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay hidden">
    <div class="loading-spinner">
      <div class="spinner"></div>
      <p>Loading...</p>
    </div>
  </div>

  <script>
    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      console.log('‚úÖ Main page loaded successfully');
      
      // Check if loadPage function is available
      if (typeof window.loadPage === 'function') {
        console.log('‚úÖ loadPage function is available');
      } else {
        console.error('‚ùå loadPage function is not available');
        // Retry loading navigation script
        setTimeout(() => {
          if (typeof window.loadPage === 'function') {
            console.log('‚úÖ loadPage function loaded after retry');
          } else {
            console.error('‚ùå loadPage function still not available after retry');
          }
        }, 1000);
      }
      
      // Ensure sidebar is visible initially
      ensureSidebarVisible();
      
             // No need for fullscreen mode observer since STATUS page opens in new tab
       console.log('üì± STATUS page opens in new tab - no fullscreen mode needed');
    });
    
    // Function to ensure sidebar is always visible
    function ensureSidebarVisible() {
      const sidebar = document.getElementById('mainSidebar');
      if (sidebar) {
        sidebar.style.display = 'block';
        sidebar.style.width = '16rem';
        sidebar.style.margin = '';
        sidebar.style.padding = '';
        console.log('üîß Ensuring sidebar visibility');
      }
    }
    
    // Function to toggle fullscreen mode manually (now just opens STATUS in new tab)
    function toggleFullscreenMode() {
      console.log('üñ•Ô∏è Fullscreen mode requested - opening STATUS page in new tab');
      openStatusInNewTab();
    }
    
    // Show status message function
    function showStatus(message, type = 'info') {
      try {
        // Create or update status element
        let statusElement = document.getElementById('statusMessage');
        if (!statusElement) {
          statusElement = document.createElement('div');
          statusElement.id = 'statusMessage';
          statusElement.className = 'fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg';
          document.body.appendChild(statusElement);
        }
        
        // Set message and styling
        const bgColor = {
          'info': 'bg-blue-500',
          'success': 'bg-green-500',
          'error': 'bg-red-500',
          'warning': 'bg-yellow-500'
        }[type] || 'bg-blue-500';
        
        statusElement.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg text-white ${bgColor}`;
        statusElement.textContent = message;
        
        // Auto-hide after 3 seconds
        setTimeout(() => {
          if (statusElement) {
            statusElement.remove();
          }
        }, 3000);
        
      } catch (error) {
        console.error('‚ùå Error showing status:', error);
      }
    }
    
    // Function to open STATUS page in new tab
    function openStatusInNewTab() {
      try {
        console.log('üöõ Opening STATUS page in new tab...');
        
        // STATUS ÌéòÏù¥ÏßÄÎ•º ÏÉà ÌÉ≠ÏóêÏÑú Ïó¥Í∏∞
        const statusUrl = window.location.origin + window.location.pathname.replace('/index.html', '') + '/pages/truck/status.html';
        const newTab = window.open(statusUrl, '_blank');
        
        if (newTab) {
          console.log('‚úÖ STATUS page opened in new tab:', statusUrl);
          
          // ÏÉà ÌÉ≠Ïù¥ Ïó¥Î¶∞ ÌõÑ ÌòÑÏû¨ ÌÉ≠Ïóê ÏÉÅÌÉú Î©îÏãúÏßÄ ÌëúÏãú
          showStatus('üì∫ STATUS ÌéòÏù¥ÏßÄÍ∞Ä ÏÉà ÌÉ≠ÏóêÏÑú Ïó¥Î†∏ÏäµÎãàÎã§.', 'success');
        } else {
          console.error('‚ùå Failed to open STATUS page in new tab');
          showStatus('‚ùå ÌåùÏóÖ Ï∞®Îã®ÏúºÎ°ú Ïù∏Ìï¥ ÏÉà ÌÉ≠ÏùÑ Ïó¥ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
          
          // ÌåùÏóÖÏù¥ Ï∞®Îã®Îêú Í≤ΩÏö∞ ÌòÑÏû¨ ÌÉ≠ÏóêÏÑú Ïó¥Í∏∞
          setTimeout(() => {
            if (confirm('ÌåùÏóÖÏù¥ Ï∞®Îã®ÎêòÏóàÏäµÎãàÎã§. ÌòÑÏû¨ ÌÉ≠ÏóêÏÑú STATUS ÌéòÏù¥ÏßÄÎ•º Ïó¥ÍπåÏöî?')) {
              window.location.href = statusUrl;
            }
          }, 1000);
        }
        
      } catch (error) {
        console.error('‚ùå Error opening STATUS page in new tab:', error);
        showStatus('‚ùå STATUS ÌéòÏù¥ÏßÄ Ïó¥Í∏∞ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
      }
    }
    
    // Make functions globally accessible
    window.toggleFullscreenMode = toggleFullscreenMode;
    window.ensureSidebarVisible = ensureSidebarVisible;
    window.showStatus = showStatus;
    window.openStatusInNewTab = openStatusInNewTab;
  </script>
</body>
</html>
